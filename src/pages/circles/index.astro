---
import BaseLayout from "../../layouts/BaseLayout.astro";
import JsonLd from "../../components/JsonLd.astro";

/**
 * ãƒ€ãƒŸãƒ¼ã®ã‚µãƒ¼ã‚¯ãƒ«ä¸€è¦§ï¼ˆ/circles/[id].astro ã¨IDæ•´åˆï¼‰
 * å®Ÿé‹ç”¨ã§ã¯ API/DB ã«å·®ã—æ›¿ãˆã€‚
 */
const circles = [
  {
    id: "cl-001",
    name: "ãƒŸãƒ³ãƒŠã§ãƒã‚¹ã‚±",
    intro: "åˆå¿ƒè€…ï½çµŒé¨“è€…ã¾ã§å¹…åºƒãã€‚è©¦åˆã‚ˆã‚Šäº¤æµé‡è¦–ï¼",
    image: "/og.png",
    memberCount: 42,
    areaText: "æ±Ÿæ±åŒºãƒ»å¢¨ç”°åŒº",
    tags: ["ãƒã‚¹ã‚±","äº¤æµ","åˆå¿ƒè€…OK"]
  },
  {
    id: "cl-002",
    name: "æ¸…æ¾„ã‚³ãƒ¼ãƒ’ãƒ¼å·¡ã‚Šéƒ¨",
    intro: "é€±ä¸€ã§ã‚³ãƒ¼ãƒ’ãƒ¼åº—ã‚’æ¢è¨ªã€‚è±†çŸ¥è­˜äº¤æ›ã—ã¾ã—ã‚‡ã†ã€‚",
    image: "/og.png",
    memberCount: 18,
    areaText: "æ¸…æ¾„ç™½æ²³ãƒ»é–€å‰ä»²ç”º",
    tags: ["ã‚«ãƒ•ã‚§","ã‚³ãƒ¼ãƒ’ãƒ¼","è¡—æ­©ã"]
  },
  {
    id: "cl-003",
    name: "è¦ªå­ã§å¤–éŠã³",
    intro: "å°ã•ãªãŠå­ã•ã‚“æ­“è¿ã€‚æ°´éŠã³ãƒ»å…¬åœ’ãƒ”ã‚¯ãƒ‹ãƒƒã‚¯ãªã©ã€‚",
    image: "/og.png",
    memberCount: 27,
    areaText: "æ±é™½ç”ºãƒ»æœ‰æ˜",
    tags: ["è¦ªå­","å¤–éŠã³","ãƒ”ã‚¯ãƒ‹ãƒƒã‚¯"]
  }
];

/** ãƒ¡ã‚¿ */
const pageTitle = "ã‚µãƒ¼ã‚¯ãƒ«ä¸€è¦§ | MinnaCircle";
const pageDesc  = "MinnaCircleã®ã‚µãƒ¼ã‚¯ãƒ«ä¸€è¦§ã€‚æ´»å‹•ã‚¨ãƒªã‚¢ãƒ»ãƒ¡ãƒ³ãƒãƒ¼æ•°ãƒ»ç´¹ä»‹æ–‡ã‚’ç¢ºèªã§ãã¾ã™ã€‚";

/** ã‚µã‚¤ãƒˆOriginï¼ˆastro.configã®siteãŒã‚ã‚Œã°ä½¿ç”¨ï¼‰ */
const siteOrigin = (Astro.site && Astro.site.href) ? Astro.site.href.replace(/\/$/, "") : "";

/** ItemList(JSON-LD) ã‚’ç”Ÿæˆï¼ˆå„ item ã¯ Organization ã‚’å†…åŒ…ï¼‰ */
const itemListLd = {
  "@context": "https://schema.org",
  "@type": "ItemList",
  "name": "MinnaCircle Circles",
  "itemListElement": circles.map((c, i) => ({
    "@type": "ListItem",
    "position": i + 1,
    "name": c.name,
    ...(siteOrigin ? { "url": `${siteOrigin}/circles/${c.id}` } : {}),
    "image": c.image,
    "description": c.intro,
    "item": {
      "@type": "Organization",
      "name": c.name,
      ...(siteOrigin ? { "url": `${siteOrigin}/circles/${c.id}` } : {}),
      ...(siteOrigin ? { "logo": `${siteOrigin}${c.image}` } : {}),
    }
  }))
};
---

<BaseLayout title={pageTitle} lang="ja" description={pageDesc}>
  <!-- JSON-LD: ItemListï¼ˆã‚µãƒ¼ã‚¯ãƒ«ä¸€è¦§ï¼‰ -->
  <JsonLd data={itemListLd} />

  <section class="max-w-6xl mx-auto px-4 py-8 md:py-12">
    <h1 class="text-2xl md:text-3xl font-extrabold mb-6">ã‚µãƒ¼ã‚¯ãƒ«ä¸€è¦§</h1>

    <!-- ãƒŠãƒ“ -->
    <div class="mb-6 flex flex-wrap gap-3 text-sm">
      <a href="/search?type=circle" class="px-4 py-2 rounded-xl border hover:bg-gray-50">ã‚µãƒ¼ã‚¯ãƒ«ã‚’æ¤œç´¢</a>
      <a href="/vendor/new" class="px-4 py-2 rounded-xl border hover:bg-gray-50">ã‚µãƒ¼ã‚¯ãƒ«ã‚’ä½œæˆ</a>
    </div>

    <!-- ã‚°ãƒªãƒƒãƒ‰ -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      {circles.map((c) => (
        <a href={`/circles/${c.id}`} class="block bg-white rounded-2xl shadow hover:shadow-md transition">
          <img src={c.image} alt={c.name} class="rounded-t-2xl w-full h-40 object-cover" loading="lazy" />
          <div class="p-4">
            <h2 class="font-bold line-clamp-2">{c.name}</h2>
            <p class="text-sm text-gray-600 mt-1 line-clamp-2">{c.intro}</p>
            <div class="mt-2 text-xs text-gray-500 space-y-1">
              <div>ğŸ§­ {c.areaText}</div>
              <div>ğŸ‘¥ {c.memberCount}äºº</div>
            </div>
            <div class="mt-2 flex flex-wrap gap-1">
              {c.tags?.map((t) => <span class="px-2 py-0.5 bg-indigo-50 text-indigo-700 rounded-full text-[11px]">{t}</span>)}
            </div>
          </div>
        </a>
      ))}
    </div>
  </section>
</BaseLayout>
