---
import BaseLayout from "../../layouts/BaseLayout.astro";
import JsonLd from "../../components/JsonLd.astro";

/**
 * ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼ˆè©³ç´°ãƒšãƒ¼ã‚¸ã¨åŒä¸€IDã‚’ä½¿ç”¨ï¼‰
 * å®Ÿãƒ‡ãƒ¼ã‚¿æ¥ç¶šæ™‚ã¯ API/DB ã‹ã‚‰å–å¾—ã—ã¦ãã ã•ã„ã€‚
 */
const allEvents = [
  {
    id: "ev-001",
    title: "æœæ´»ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ï¼ æœ¨å ´å…¬åœ’",
    description: "åˆå¿ƒè€…æ­“è¿ã€‚ä¼šè©±ã—ãªãŒã‚‰è»½ã3kmï¼ã‚¦ã‚©ãƒ¼ãƒ ã‚¢ãƒƒãƒ—â†’ã‚†ã‚‹ãƒ©ãƒ³â†’ã‚¹ãƒˆãƒ¬ãƒƒãƒã®æµã‚Œã§ã™ã€‚",
    image: "/og.png",
    dateText: "2025-09-01 07:00",
    endText:  "2025-09-01 08:00",
    placeText: "æœ¨å ´å…¬åœ’é›†åˆ",
    areaText: "æ±Ÿæ±åŒº",
    fee: 0,
    capacity: 20,
    organizer: "MinnaCircle Running",
    createdAt: "2025-08-10T08:00:00+09:00",
    tags: ["ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°","åˆå¿ƒè€…æ­“è¿","æœæ´»"]
  },
  {
    id: "ev-002",
    title: "é€±æœ«ãƒã‚¹ã‚±å€‹äººå‚åŠ ",
    description: "çµŒé¨“ä¸å•ã€‚ãƒãƒ¼ãƒ åˆ†ã‘â†’ã‚¹ã‚¯ãƒªãƒ¡ãƒ¼ã‚¸ä¸­å¿ƒã€‚æ€ªæˆ‘é˜²æ­¢ã®ãŸã‚æº–å‚™é‹å‹•ã‚’å„è‡ªã§ãŠé¡˜ã„ã—ã¾ã™ã€‚",
    image: "/og.png",
    dateText: "2025-09-06 18:00",
    endText:  "2025-09-06 20:00",
    placeText: "æ±Ÿæ±åŒºã‚¹ãƒã‚»ãƒ³",
    areaText: "æ±Ÿæ±åŒº",
    fee: 800,
    capacity: 30,
    organizer: "MinnaCircle Basketball",
    createdAt: "2025-08-14T18:00:00+09:00",
    tags: ["ãƒã‚¹ã‚±","å€‹ã‚µãƒ«","åˆå¿ƒè€…æ­“è¿"]
  },
  {
    id: "ev-003",
    title: "è‹±ä¼šè©±ã‚†ã‚‹ã‚«ãƒ•ã‚§ä¼š",
    description: "ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«è‹±ä¼šè©±ã€‚ãƒ¬ãƒ™ãƒ«ä¸å•ã€‚å­é€£ã‚Œå¯ã€‚ã‚¹ãƒ¢ãƒ¼ãƒ«ãƒˆãƒ¼ã‚¯ã®ãƒ†ãƒ¼ãƒã‚«ãƒ¼ãƒ‰ã‚’ç”¨æ„ã—ã¾ã™ã€‚",
    image: "/og.png",
    dateText: "2025-09-07 10:00",
    endText:  "2025-09-07 11:30",
    placeText: "æ¸…æ¾„ç™½æ²³",
    areaText: "æ±Ÿæ±åŒº",
    fee: 500,
    capacity: 12,
    organizer: "MinnaCircle English",
    createdAt: "2025-08-12T12:00:00+09:00",
    tags: ["è‹±ä¼šè©±","ã‚«ãƒ•ã‚§","è¦ªå­OK"]
  }
];

/** ãƒ¡ã‚¿ */
const pageTitle = "ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ | MinnaCircle";
const pageDesc  = "MinnaCircleã®æœ€æ–°ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ã€‚æ—¥æ™‚ãƒ»å ´æ‰€ãƒ»è²»ç”¨ã‹ã‚‰æ¤œç´¢ã§ãã¾ã™ã€‚";

/** ã‚µã‚¤ãƒˆOriginï¼ˆastro.configã®siteãŒã‚ã‚Œã°ä½¿ç”¨ï¼‰ */
const siteOrigin = (Astro.site && Astro.site.href) ? Astro.site.href.replace(/\/$/, "") : "";

/** ItemList JSON-LD ã‚’ç”Ÿæˆ */
const itemListLd = {
  "@context": "https://schema.org",
  "@type": "ItemList",
  "name": "MinnaCircle Events",
  "itemListElement": allEvents.map((e, i) => ({
    "@type": "ListItem",
    "position": i + 1,
    "name": e.title,
    ...(siteOrigin ? { "url": `${siteOrigin}/events/${e.id}` } : {}),
    "image": e.image,
    "description": e.description
  }))
};
---

<BaseLayout title={pageTitle} lang="ja" description={pageDesc}>
  <!-- JSON-LD: ItemListï¼ˆã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ï¼‰ -->
  <JsonLd data={itemListLd} />

  <section class="max-w-6xl mx-auto px-4 py-8 md:py-12">
    <h1 class="text-2xl md:text-3xl font-extrabold mb-6">ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§</h1>

    <!-- æ¤œç´¢/ã‚½ãƒ¼ãƒˆUIï¼ˆç°¡æ˜“ï¼‰ -->
    <div class="mb-6 flex flex-wrap gap-3 text-sm">
      <a href="/search?type=event" class="px-4 py-2 rounded-xl border hover:bg-gray-50">è©³ç´°æ¤œç´¢ã¸</a>
    </div>

    <!-- ã‚°ãƒªãƒƒãƒ‰è¡¨ç¤º -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      {allEvents.map((e) => (
        <a href={`/events/${e.id}`} class="block bg-white rounded-2xl shadow hover:shadow-md transition">
          <img src={e.image} alt={e.title} class="rounded-t-2xl w-full h-40 object-cover" loading="lazy" />
          <div class="p-4">
            <h2 class="font-bold line-clamp-2">{e.title}</h2>
            <p class="text-sm text-gray-600 mt-1 line-clamp-2">{e.description}</p>
            <div class="mt-2 text-xs text-gray-500 space-y-1">
              <div>ğŸ“… {e.dateText}{e.endText ? ` ã€œ ${e.endText}` : ""}</div>
              <div>ğŸ“ {e.placeText}ï¼ˆ{e.areaText}ï¼‰</div>
              {Number.isFinite(e.fee) && (<div>ğŸ’´ {e.fee === 0 ? "ç„¡æ–™" : `Â¥${e.fee.toLocaleString()}`}</div>)}
            </div>
            <div class="mt-2 flex flex-wrap gap-1">
              {e.tags?.map((t) => <span class="px-2 py-0.5 bg-indigo-50 text-indigo-700 rounded-full text-[11px]">{t}</span>)}
            </div>
          </div>
        </a>
      ))}
    </div>
  </section>
</BaseLayout>
